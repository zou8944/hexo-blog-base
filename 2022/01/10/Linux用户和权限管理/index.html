<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83equib0YGKeGrRww67LyZ7hSONtAW59RHDTd2JuKmSfQLEs8zWIB14hUcHibNG41zNibv5mr5QhM5QDMQ/132">
  <link rel="icon" type="image/png" sizes="32x32" href="https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83equib0YGKeGrRww67LyZ7hSONtAW59RHDTd2JuKmSfQLEs8zWIB14hUcHibNG41zNibv5mr5QhM5QDMQ/132">
  <link rel="icon" type="image/png" sizes="16x16" href="https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83equib0YGKeGrRww67LyZ7hSONtAW59RHDTd2JuKmSfQLEs8zWIB14hUcHibNG41zNibv5mr5QhM5QDMQ/132">
  <link rel="mask-icon" href="https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83equib0YGKeGrRww67LyZ7hSONtAW59RHDTd2JuKmSfQLEs8zWIB14hUcHibNG41zNibv5mr5QhM5QDMQ/132" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"zou8944.com","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"always","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="这是Linux系列第二篇文章，本来觉得Shell写完就OK了。但仔细一梳理发现对很多Linux要么是一知半解，要么是忘了。既然如此，还是遇到什么就回顾什么吧。本文试图解决以下问题  Linux如何做用户管理 用户和权限的关系 一个用户安装软件后，其它用户能否使用，这是如何决定的？ 与此相关的命令的使用方式">
<meta property="og:type" content="article">
<meta property="og:title" content="Linux用户和权限管理">
<meta property="og:url" content="https://zou8944.com/2022/01/10/Linux%E7%94%A8%E6%88%B7%E5%92%8C%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86/index.html">
<meta property="og:site_name" content="半中二青年">
<meta property="og:description" content="这是Linux系列第二篇文章，本来觉得Shell写完就OK了。但仔细一梳理发现对很多Linux要么是一知半解，要么是忘了。既然如此，还是遇到什么就回顾什么吧。本文试图解决以下问题  Linux如何做用户管理 用户和权限的关系 一个用户安装软件后，其它用户能否使用，这是如何决定的？ 与此相关的命令的使用方式">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2022-01-10T14:09:40.000Z">
<meta property="article:modified_time" content="2022-01-13T15:14:57.798Z">
<meta property="article:author" content="果冻">
<meta property="article:tag" content="Linux">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://zou8944.com/2022/01/10/Linux%E7%94%A8%E6%88%B7%E5%92%8C%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>Linux用户和权限管理 | 半中二青年</title>
  


  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?5f106bd9d28ad9215669a37fc984f768";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">半中二青年</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">果冻的碎碎念</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">115</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">34</span></a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">86</span></a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/me" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://zou8944.com/2022/01/10/Linux%E7%94%A8%E6%88%B7%E5%92%8C%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83equib0YGKeGrRww67LyZ7hSONtAW59RHDTd2JuKmSfQLEs8zWIB14hUcHibNG41zNibv5mr5QhM5QDMQ/132">
      <meta itemprop="name" content="果冻">
      <meta itemprop="description" content="果冻的碎碎念">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="半中二青年">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Linux用户和权限管理
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-01-10 22:09:40" itemprop="dateCreated datePublished" datetime="2022-01-10T22:09:40+08:00">2022-01-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-01-13 23:14:57" itemprop="dateModified" datetime="2022-01-13T23:14:57+08:00">2022-01-13</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a>
                </span>
            </span>

          
            <span id="/2022/01/10/Linux%E7%94%A8%E6%88%B7%E5%92%8C%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86/" class="post-meta-item leancloud_visitors" data-flag-title="Linux用户和权限管理" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>这是Linux系列第二篇文章，本来觉得Shell写完就OK了。但仔细一梳理发现对很多Linux要么是一知半解，要么是忘了。既然如此，还是遇到什么就回顾什么吧。本文试图解决以下问题</p>
<ul>
<li>Linux如何做用户管理</li>
<li>用户和权限的关系</li>
<li>一个用户安装软件后，其它用户能否使用，这是如何决定的？</li>
<li>与此相关的命令的使用方式</li>
</ul>
<span id="more"></span>

<h2 id="概览"><a href="#概览" class="headerlink" title="概览"></a>概览</h2><p>Linux的权限管理，与两个重要的特性关联甚密：一切皆文件；多用户操作系统。多用户操作系统，意味着用户之间的资源需要隔离，就有了权限存在的必要性；一切皆文件，意味着权限管理的目标只有文件。</p>
<p>Linux有两种权限管理机制</p>
<ul>
<li>原生的权限管理机制(Discretionary Access Control, DAC)，也就是UGO+RWX/ACL的权限控制。UGO标识User、Group、Other；RWX表示Read、Write、Execute；ACL表示Access Control List，即权限控制列表。这是默认的控制方式，也是我们需要关注的方式。</li>
<li>SELinux的强制访问控制(Mandatory Access Control )，即基于标签的访问控制，将所有资源打上标签，程序只能访问有标签的资源，不能访问无标签的资源。这个不在本文讨论范围内。</li>
</ul>
<h2 id="基于用户角色的管理机制"><a href="#基于用户角色的管理机制" class="headerlink" title="基于用户角色的管理机制"></a>基于用户角色的管理机制</h2><h3 id="用户、组"><a href="#用户、组" class="headerlink" title="用户、组"></a>用户、组</h3><p>Linux对账户和组的管理通过ID实现，而不是用户名。用户和组的ID分别对应UID和GID。一个用户可以属于多个组，但只能属于一个基本组，可以属于多个附加组。用户用于精确授权，组用于批量授权。可以理解为RBAC中的用户和角色关系。</p>
<blockquote>
<p>基本组和附加组的区别</p>
<p>基本组：如果没有指定用户组，创建用户的时候系统会默认同时创建一个和这个用户名同名的组，这个组就是基本组，不可以把用户从基本组中删除。在创建文件时，文件的所属组就是用户的基本组。</p>
<p>附加组：除了基本组之外，用户所在的其他组，都是附加组。用户是可以从附加组中被删除的。</p>
</blockquote>
<h4 id="useradd"><a href="#useradd" class="headerlink" title="useradd"></a>useradd</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 创建账号guodong</span></span><br><span class="line">useradd guodong</span><br><span class="line"><span class="meta">#</span><span class="bash"> 创建账号guodong，设置描述信息为Administrator、家目录为/home/guodong、设置失效日期为03-04、基本组为root、附加组为mail</span></span><br><span class="line">useradd -c administrator -d /home/guodong -e 2022-03-04 -g root -G mail guodong</span><br></pre></td></tr></table></figure>

<p>创建完后可以到/etc/passwd文件下查看刚创建的用户，其含义在后文描述。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">guodong:x:1002:1002::/home/guodong:/bin/sh</span><br></pre></td></tr></table></figure>

<p>所有的参数说明如下，它能够设置的参数包括家目录、组、是否同时创建家目录、密码(编码后的)、指定UID、指定shell等。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">root@VM-20-5-ubuntu:~# useradd --help</span><br><span class="line">Usage: useradd [options] LOGIN</span><br><span class="line">       useradd -D</span><br><span class="line">       useradd -D [options]</span><br><span class="line"></span><br><span class="line">Options:</span><br><span class="line">      --badnames                do not check for bad names</span><br><span class="line">  -b, --base-dir BASE_DIR       base directory for the home directory of the</span><br><span class="line">                                new account</span><br><span class="line">      --btrfs-subvolume-home    use BTRFS subvolume for home directory</span><br><span class="line">  -c, --comment COMMENT         GECOS field of the new account</span><br><span class="line">  -d, --home-dir HOME_DIR       home directory of the new account</span><br><span class="line">  -D, --defaults                print or change default useradd configuration</span><br><span class="line">  -e, --expiredate EXPIRE_DATE  expiration date of the new account</span><br><span class="line">  -f, --inactive INACTIVE       password inactivity period of the new account</span><br><span class="line">  -g, --gid GROUP               name or ID of the primary group of the new</span><br><span class="line">                                account</span><br><span class="line">  -G, --groups GROUPS           list of supplementary groups of the new</span><br><span class="line">                                account</span><br><span class="line">  -h, --help                    display this help message and exit</span><br><span class="line">  -k, --skel SKEL_DIR           use this alternative skeleton directory</span><br><span class="line">  -K, --key KEY=VALUE           override /etc/login.defs defaults</span><br><span class="line">  -l, --no-log-init             do not add the user to the lastlog and</span><br><span class="line">                                faillog databases</span><br><span class="line">  -m, --create-home             create the user&#x27;s home directory</span><br><span class="line">  -M, --no-create-home          do not create the user&#x27;s home directory</span><br><span class="line">  -N, --no-user-group           do not create a group with the same name as</span><br><span class="line">                                the user</span><br><span class="line">  -o, --non-unique              allow to create users with duplicate</span><br><span class="line">                                (non-unique) UID</span><br><span class="line">  -p, --password PASSWORD       encrypted password of the new account</span><br><span class="line">  -r, --system                  create a system account</span><br><span class="line">  -R, --root CHROOT_DIR         directory to chroot into</span><br><span class="line">  -P, --prefix PREFIX_DIR       prefix directory where are located the /etc/* files</span><br><span class="line">  -s, --shell SHELL             login shell of the new account</span><br><span class="line">  -u, --uid UID                 user ID of the new account</span><br><span class="line">  -U, --user-group              create a group with the same name as the user</span><br><span class="line">  -Z, --selinux-user SEUSER     use a specific SEUSER for the SELinux user mapping</span><br><span class="line">      --extrausers              Use the extra users database</span><br></pre></td></tr></table></figure>

<p>如果什么选项都不加，默认会做如下几件事</p>
<ul>
<li>创建用户</li>
<li>创建用户的主目录</li>
<li>创建用户同名的组，并将用户放入其中</li>
</ul>
<h4 id="groupadd"><a href="#groupadd" class="headerlink" title="groupadd"></a>groupadd</h4><p>添加组</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 创建gg组</span></span><br><span class="line">groupadd gg</span><br><span class="line"><span class="meta">#</span><span class="bash"> 创建用户guodong，并将gg作为其primary组。</span></span><br><span class="line">useradd guodong -g gg</span><br></pre></td></tr></table></figure>

<p>添加后/etc/group文档，含义后面说</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">guodong:x:1002:</span><br></pre></td></tr></table></figure>

<p>命令详情</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">ubuntu@VM-20-5-ubuntu:~$ groupadd --help</span><br><span class="line">Usage: groupadd [options] GROUP</span><br><span class="line"></span><br><span class="line">Options:</span><br><span class="line">  -f, --force                   exit successfully if the group already exists,</span><br><span class="line">                                and cancel -g if the GID is already used</span><br><span class="line">  -g, --gid GID                 use GID for the new group</span><br><span class="line">  -h, --help                    display this help message and exit</span><br><span class="line">  -K, --key KEY=VALUE           override /etc/login.defs defaults</span><br><span class="line">  -o, --non-unique              allow to create groups with duplicate</span><br><span class="line">                                (non-unique) GID</span><br><span class="line">  -p, --password PASSWORD       use this encrypted password for the new group</span><br><span class="line">  -r, --system                  create a system account</span><br><span class="line">  -R, --root CHROOT_DIR         directory to chroot into</span><br><span class="line">  -P, --prefix PREFIX_DIR       directory prefix</span><br><span class="line">      --extrausers              Use the extra users database</span><br></pre></td></tr></table></figure>

<h4 id="id"><a href="#id" class="headerlink" title="id"></a>id</h4><p>查看某个用户的详情，会打印出uid、所属组gid、所属组等。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ubuntu@VM-20-5-ubuntu:~$ id guodong</span><br><span class="line">uid=1002(guodong) gid=1002(guodong) groups=1002(guodong),0(root)</span><br></pre></td></tr></table></figure>

<p>命令详情，增加参数可以仅打印部分内容</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">ubuntu@VM-20-5-ubuntu:~$ id --help</span><br><span class="line">Usage: id [OPTION]... [USER]</span><br><span class="line">Print user and group information for the specified USER,</span><br><span class="line">or (when USER omitted) for the current user.</span><br><span class="line"></span><br><span class="line">  -a             ignore, for compatibility with other versions</span><br><span class="line">  -Z, --context  print only the security context of the process</span><br><span class="line">  -g, --group    print only the effective group ID</span><br><span class="line">  -G, --groups   print all group IDs</span><br><span class="line">  -n, --name     print a name instead of a number, for -ugG</span><br><span class="line">  -r, --real     print the real ID instead of the effective ID, with -ugG</span><br><span class="line">  -u, --user     print only the effective user ID</span><br><span class="line">  -z, --zero     delimit entries with NUL characters, not whitespace;</span><br><span class="line">                   not permitted in default format</span><br><span class="line">      --help     display this help and exit</span><br><span class="line">      --version  output version information and exit</span><br></pre></td></tr></table></figure>

<h4 id="passwd"><a href="#passwd" class="headerlink" title="passwd"></a>passwd</h4><p>修改某个用户的密码</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ubuntu@VM-20-5-ubuntu:~$ sudo passwd guodong</span><br><span class="line">New password: </span><br><span class="line">Retype new password: </span><br><span class="line">passwd: password updated successfully</span><br></pre></td></tr></table></figure>

<h4 id="usermod"><a href="#usermod" class="headerlink" title="usermod"></a>usermod</h4><p>修改用户信息，如密码、家目录、组信息等。能够修改的信息和useradd类似</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 修改guodong的描述信息</span></span><br><span class="line">ubuntu@VM-20-5-ubuntu:~$ usermod guodong -c 果冻</span><br><span class="line">ubuntu@VM-20-5-ubuntu:~$ cat /etc/passwd | grep guodong</span><br><span class="line">guodong:x:1002:1002:果冻:/home/guodong:/bin/sh</span><br></pre></td></tr></table></figure>

<h4 id="userdel、groupdel"><a href="#userdel、groupdel" class="headerlink" title="userdel、groupdel"></a>userdel、groupdel</h4><p>删除用户</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 删除用户</span></span><br><span class="line">userdel guodong</span><br><span class="line"><span class="meta">#</span><span class="bash"> 删除组</span></span><br><span class="line">groupdel guodong</span><br></pre></td></tr></table></figure>

<h4 id="相关文件"><a href="#相关文件" class="headerlink" title="相关文件"></a>相关文件</h4><ul>
<li><p>/etc/passwd</p>
<p>存放用户的问题</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@VM-20-5-ubuntu:~# cat /etc/passwd | grep ubuntu</span><br><span class="line">ubuntu:x:1000:1000:ubuntu:/home/ubuntu:/bin/bash</span><br></pre></td></tr></table></figure>

<p>总计被分为7段。从左到右，为，<code>用户名 : 口令 : UID : GID : 描述信息 : 家目录 : 登录shell</code></p>
<p>注意口令字段，存储的只是一个x，它只是表示有密码，真正的密码在/etc/shadow中</p>
<blockquote>
<p>伪用户：整个passwd文件中还有很多没有登录shell的用户，他们叫做伪用户，不能登录，只是为了方便系统管理而存在的。</p>
</blockquote>
</li>
<li><p>/etc/group</p>
<p>存放组的文件</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">root@VM-20-5-ubuntu:~# cat /etc/group | grep ubuntu</span><br><span class="line">adm:x:4:syslog,ubuntu</span><br><span class="line">cdrom:x:24:ubuntu</span><br><span class="line">sudo:x:27:ubuntu</span><br><span class="line">dip:x:30:ubuntu</span><br><span class="line">plugdev:x:46:ubuntu</span><br><span class="line">lxd:x:116:ubuntu</span><br><span class="line">ubuntu:x:1000:</span><br><span class="line"></span><br><span class="line">root@VM-20-5-ubuntu:~# id ubuntu</span><br><span class="line">uid=1000(ubuntu) gid=1000(ubuntu) groups=1000(ubuntu),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),116(lxd)</span><br></pre></td></tr></table></figure>

<p>总计4个字段，<code>组名:组密码:GID:组内用户列表</code>。上面的命令中，刚好可以把<code>id ubuntu</code>得到的groups和上面的<code>/etc/group</code>包含ubuntu用户的组对应起来。</p>
<blockquote>
<p>组密码，用于在非本组用户切换到本组时的鉴权</p>
</blockquote>
</li>
<li><p>/etc/shadow</p>
<p>存放用户密码的文件</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@VM-20-5-ubuntu:~# cat /etc/shadow | grep ubuntu</span><br><span class="line">ubuntu:$6$jljvtYI5RLrh6ZwE$C/s2cHElV8XZ./cWGEV09ICjEavrLivzkpa0T/Sil1Xjv5rFTGAmSzOVDlBx8a8zUnvMlMNFcqrWt8k.F1ZHF0:18979:0:99999:7:::</span><br></pre></td></tr></table></figure>

<p>总计9个字段，<code>用户名:加密密码:最后一次修改时间:最小修改时间间隔:密码有效期:密码需要变更前的警告天数:密码过期后的宽限时间:账号失效时间:保留字段</code></p>
<p>加密密码使用了SHA512散列算法。</p>
<blockquote>
<p>伪用户的密码为!!或*，代表不能登录</p>
</blockquote>
</li>
<li><p>/etc/gshadow</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">root@VM-20-5-ubuntu:~# cat /etc/gshadow | grep ubuntu</span><br><span class="line">adm:*::syslog,ubuntu</span><br><span class="line">cdrom:*::ubuntu</span><br><span class="line">sudo:*::ubuntu</span><br><span class="line">dip:*::ubuntu</span><br><span class="line">plugdev:*::ubuntu</span><br><span class="line">lxd:!::ubuntu</span><br><span class="line">ubuntu:!::</span><br></pre></td></tr></table></figure>

<p>总计4个字段，<code>组名:组密码:组管理员名:支持的账号名</code></p>
</li>
<li><p>/etc/login.defs</p>
<p>设置用户账号限制的文件，该文件的配置对root用户无效。它用户在Linux创建用户时，对用户做一些默认的设置，比如UID范围、用户过期时间等。</p>
</li>
</ul>
<h3 id="文件权限"><a href="#文件权限" class="headerlink" title="文件权限"></a>文件权限</h3><h4 id="详述"><a href="#详述" class="headerlink" title="详述"></a>详述</h4><p>随便看一个文件</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@VM-20-5-ubuntu:~# ls -l /etc/login.defs</span><br><span class="line">-rw-r--r-- 1 root root 10550 Feb  7  2020 /etc/login.defs</span><br></pre></td></tr></table></figure>

<p>从左到右，依次为</p>
<ul>
<li>文件类型：-表示文件，d表示目录，c表示字符型文件，l表示链接文件</li>
<li>UGO权限：文件所有者、文件所有人所属组、其它人的权限，依次为读、写、执行，即RWX</li>
<li>连接计数：连接计数-2=本目录直接包含的子目录和文件总数；文件为1</li>
<li>文件所有者</li>
<li>文件所属组</li>
<li>大小，单位Byte</li>
<li>修改日期</li>
<li>文件名</li>
</ul>
<blockquote>
<p>rwx，文件和目录不一样，目录的如下</p>
<table>
<thead>
<tr>
<th>rwx 权限</th>
<th>对目录的作用</th>
</tr>
</thead>
<tbody><tr>
<td>读权限（r）</td>
<td>表示具有读取目录结构列表的权限，也就是说，可以看到目录中有哪些文件和子目录。一旦对目录拥有 r 权限，就可以在此目录下执行 ls 命令，查看目录中的内容。</td>
</tr>
<tr>
<td>写权限（w）</td>
<td>对于目录来说，w 权限是最高权限。对目录拥有 w 权限，表示可以对目录做以下操作：在此目录中建立新的文件或子目录；删除已存在的文件和目录（无论子文件或子目录的权限是怎样的）；对已存在的文件或目录做更名操作；移动此目录下的文件和目录的位置。一旦对目录拥有 w 权限，就可以在目录下执行 touch、rm、cp、mv 等命令。</td>
</tr>
<tr>
<td>执行权限（x）</td>
<td>目录是不能直接运行的，对目录赋予 x 权限，代表用户可以进入目录，也就是说，赋予 x 权限的用户或群组可以使用 cd 命令。</td>
</tr>
</tbody></table>
</blockquote>
<blockquote>
<p>如果对rwx不了解，可以网上搜索，一搜一大堆</p>
</blockquote>
<h4 id="chmod"><a href="#chmod" class="headerlink" title="chmod"></a>chmod</h4><p>修改文件或目录权限</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod +x hello.sh # 为hello.sh添加执行权限</span><br></pre></td></tr></table></figure>

<p>所有可能的权限为<code>[ugoa]*([-+=]([rwxXst]*|[ugo]))+|[-+=][0-7]+</code></p>
<h4 id="chown"><a href="#chown" class="headerlink" title="chown"></a>chown</h4><p>修改文件所有者，贴两个示例感受一下</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">chown root /u        Change the owner of /u to &quot;root&quot;.</span><br><span class="line">chown root:staff /u  Likewise, but also change its group to &quot;staff&quot;.</span><br><span class="line">chown -hR root /u    Change the owner of /u and subfiles to &quot;root&quot;.</span><br></pre></td></tr></table></figure>

<h2 id="其它"><a href="#其它" class="headerlink" title="其它"></a>其它</h2><h3 id="决定用户是否能sudo"><a href="#决定用户是否能sudo" class="headerlink" title="决定用户是否能sudo"></a>决定用户是否能sudo</h3><p>通过文件<code>/etc/sudoers</code>控制。文件不长，可以完整看一看</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="bash"><span class="comment"># This file MUST be edited with the &#x27;visudo&#x27; command as root.</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="bash"><span class="comment"># Please consider adding local content in /etc/sudoers.d/ instead of</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> directly modifying this file.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="bash"><span class="comment"># See the man page for details on how to write a sudoers file.</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="bash"><span class="comment"># 使用sudo时，会重置环境变量</span></span></span><br><span class="line">Defaults        env_reset</span><br><span class="line">Defaults        mail_badpass</span><br><span class="line">Defaults        secure_path=&quot;/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin&quot;</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Host <span class="built_in">alias</span> specification</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> User <span class="built_in">alias</span> specification</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Cmnd <span class="built_in">alias</span> specification</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> User privilege specification</span></span><br><span class="line">root    ALL=(ALL:ALL) ALL</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Members of the admin group may gain root privileges</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> admin组下的所有用户能够sudo</span></span><br><span class="line"><span class="meta">%</span><span class="bash">admin ALL=(ALL) ALL</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Allow members of group sudo to execute any <span class="built_in">command</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> sudo组下的所有用户能够sudo</span></span><br><span class="line"><span class="meta">%</span><span class="bash">sudo   ALL=(ALL:ALL) ALL</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> See sudoers(5) <span class="keyword">for</span> more information on <span class="string">&quot;#include&quot;</span> directives:</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">includedir /etc/sudoers.d</span></span><br><span class="line">lighthouse ALL=(ALL) NOPASSWD: ALL</span><br><span class="line"><span class="meta">#</span><span class="bash"> 用户ubuntu可以在所有主机上，切换到所有用户和组上，在不用输密码的情况下，执行所有命令</span></span><br><span class="line">ubuntu  ALL=(ALL:ALL) NOPASSWD: ALL</span><br></pre></td></tr></table></figure>

<p>配置用户的sudo权限：<strong>授权用户/组 主机=[(切换到哪些用户或组)] [是否需要输入密码验证] 命令1,命令2,…</strong></p>
<blockquote>
<p>结合这个文件的Defaults，可以了解到，使用sudo执行命令时，当前用户shell的环境变量会被重置。</p>
</blockquote>
<h3 id="决定用户是否能远程ssh"><a href="#决定用户是否能远程ssh" class="headerlink" title="决定用户是否能远程ssh"></a>决定用户是否能远程ssh</h3><p>如果需要禁止一个用户ssh登录怎么办。方法有两类</p>
<ul>
<li><p>进制该用户登录</p>
<ul>
<li>锁定账号<code>usermod -L guodong</code></li>
<li>修改用户shell为不可登录<code>/sbin/nologin</code></li>
</ul>
</li>
<li><p>修改<code>/etc/ssh/sshd_config</code></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 禁止root用户登录</span></span><br><span class="line">PermitRootLogin no</span><br><span class="line"><span class="meta">#</span><span class="bash"> 拒绝用户</span></span><br><span class="line">DenyUsers guodong</span><br></pre></td></tr></table></figure></li>
</ul>
<blockquote>
<p>补充一个知识点：我们可以限制ssh的账号密码登录</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 禁止guodong和root使用账号密码登录，其它允许</span></span><br><span class="line">Match User guodong,root</span><br><span class="line">  PasswordAuthentication no</span><br><span class="line">Match all</span><br><span class="line">  PasswordAuthentication yes</span><br></pre></td></tr></table></figure>
</blockquote>
<h2 id="权限控制与软件安装"><a href="#权限控制与软件安装" class="headerlink" title="权限控制与软件安装"></a>权限控制与软件安装</h2><p>软件安装，本质上就是将软件包的各个部分放到适当的位置，即在不同目录下创建文件或目录，有几个点比较重要</p>
<ul>
<li><p>软件的安装位置，会安装到用户的家目录吗？</p>
</li>
<li><p>新创建的文件或目录所有人、所有组是谁？这决定了那些人能够访问新安装的软件</p>
</li>
</ul>
<h3 id="软件安装位置"><a href="#软件安装位置" class="headerlink" title="软件安装位置"></a>软件安装位置</h3><p><code>apt insall</code>、<code>yum insall</code>、<code>dpkg -i </code>、<code>自由安装</code>的软件，它们最终到了哪个目录下？关于这个，了解两个点</p>
<ol>
<li>linux目录众多，但某些目录一般是有专门用途的</li>
<li>apt、yum等安装软件时软件文件存放的位置，不是由安装器自己决定的，而是软件维护者决定，所以不能一概而论</li>
</ol>
<p>对于第一点，首先了解你操作系统的PATH</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@VM-20-5-ubuntu:~# env | grep PATH</span><br><span class="line">PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin</span><br></pre></td></tr></table></figure>

<blockquote>
<p>PATH的作用，默认操作提供到PATH指定的目录中查找命令</p>
</blockquote>
<p>关于文件夹管理这玩意儿，其实<a target="_blank" rel="noopener" href="https://www.linuxbase.org/betaspecs/fhs/fhs/index.html">Linux还有个标准</a>。</p>
<p>常见的与软件安装有关的目录有</p>
<table>
<thead>
<tr>
<th>路径</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>/usr/local/sbin</td>
<td>自己编译的、根用户才能访问的命令</td>
</tr>
<tr>
<td>/usr/local/bin</td>
<td>自己编译的、大家都能访问的命令</td>
</tr>
<tr>
<td>/usr/sbin、/sbin（只是/usr/sbin的链接，至少ubuntu是如此）</td>
<td>系统的或安装的、根用户才能访问的命令</td>
</tr>
<tr>
<td>/usr/bin、/bin（它只是/usr/bin的链接，至少ubuntu是如此）</td>
<td>系统的或安装的、大家都能访问的命令</td>
</tr>
<tr>
<td>/usr/share</td>
<td>存放一些共享数据，如文档等</td>
</tr>
<tr>
<td>/usr/lib</td>
<td>存放软件所需的库文件</td>
</tr>
<tr>
<td>/etc</td>
<td>存放配置文件</td>
</tr>
<tr>
<td>/opt</td>
<td>一些可选的软件会安装在这里。<br />可选就是用户自己安装的一些无足轻重与系统无关的应用<br />比如tomcat</td>
</tr>
</tbody></table>
<p>要点1：区分<code>bin和sbin</code>、<code>/usr和/usr/local</code>，可以看看<a target="_blank" rel="noopener" href="https://www.zhihu.com/question/21265424?sort=created">知乎</a></p>
<p>要点2：我们可以查看一下usr下目录的权限，可以看到所有人都是root，只有root能够写，但是其它用户具有读和执行权限。那么可以猜测，将软件安装到这些目录，需要root权限。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">ubuntu@VM-20-5-ubuntu:~$ ls -l /usr</span><br><span class="line">total 136</span><br><span class="line">drwxr-xr-x   2 root root 57344 Dec 18 11:26 bin</span><br><span class="line">drwxr-xr-x   2 root root  4096 Dec 18 10:56 config</span><br><span class="line">drwxr-xr-x   2 root root  4096 Apr 15  2020 games</span><br><span class="line">drwxr-xr-x  10 root root 16384 Dec 18 10:33 include</span><br><span class="line">drwxr-xr-x  94 root root  4096 Dec 18 11:26 lib</span><br><span class="line">drwxr-xr-x   2 root root  4096 Apr 23  2020 lib32</span><br><span class="line">drwxr-xr-x   2 root root  4096 Jun  5  2021 lib64</span><br><span class="line">drwxr-xr-x   4 root root  4096 Dec 18 12:29 libexec</span><br><span class="line">drwxr-xr-x   2 root root  4096 Apr 23  2020 libx32</span><br><span class="line">drwxr-xr-x  12 root root  4096 Dec 18 10:33 local</span><br><span class="line">drwxr-xr-x   2 root root 20480 Jan 12 10:50 sbin</span><br><span class="line">drwxr-xr-x 159 root root  4096 Dec 18 11:09 share</span><br><span class="line">drwxr-xr-x   4 root root  4096 Nov  9 21:41 src</span><br></pre></td></tr></table></figure>

<h3 id="安装人的影响"><a href="#安装人的影响" class="headerlink" title="安装人的影响"></a>安装人的影响</h3><p>为什么有些安装需要sudo，sudo就是以root用户的身份执行此条命令。所有部分命令的执行如果需要访问root用户才有权限修改的文件或目录，则需要sudo。</p>
<p>另一个问题，一个普通用户安装的软件，另一个普通用户能用吗？这要看情况，如果将软件正常安装到上述目录中，则所有用户都能访问。但理论上可以进行不规范操作，在用户自己的家目录下安装软件，并加入PATH，则其它用户无法访问。</p>
<p>所以，这还是一个文件权限管理的问题。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>Linux的权限，归根结底管理的是文件，搞清楚文件权限、用户和组之间的关系，掌握几个关键命令，应对日常维护问题不大。</p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Linux/" rel="tag"># Linux</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2022/01/09/%E2%80%99shell%E2%80%98/" rel="prev" title="Shell编程概览">
      <i class="fa fa-chevron-left"></i> Shell编程概览
    </a></div>
      <div class="post-nav-item">
    <a href="/2022/01/22/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95%E7%90%86%E8%AE%BA/" rel="next" title="单元测试 - 理论">
      单元测试 - 理论 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    
  <div class="comments">
    <div id="lv-container" data-id="city" data-uid="MTAyMC80NjUyOC8yMzAzOA=="></div>
  </div>
  

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A6%82%E8%A7%88"><span class="nav-number">1.</span> <span class="nav-text">概览</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9F%BA%E4%BA%8E%E7%94%A8%E6%88%B7%E8%A7%92%E8%89%B2%E7%9A%84%E7%AE%A1%E7%90%86%E6%9C%BA%E5%88%B6"><span class="nav-number">2.</span> <span class="nav-text">基于用户角色的管理机制</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%94%A8%E6%88%B7%E3%80%81%E7%BB%84"><span class="nav-number">2.1.</span> <span class="nav-text">用户、组</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#useradd"><span class="nav-number">2.1.1.</span> <span class="nav-text">useradd</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#groupadd"><span class="nav-number">2.1.2.</span> <span class="nav-text">groupadd</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#id"><span class="nav-number">2.1.3.</span> <span class="nav-text">id</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#passwd"><span class="nav-number">2.1.4.</span> <span class="nav-text">passwd</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#usermod"><span class="nav-number">2.1.5.</span> <span class="nav-text">usermod</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#userdel%E3%80%81groupdel"><span class="nav-number">2.1.6.</span> <span class="nav-text">userdel、groupdel</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9B%B8%E5%85%B3%E6%96%87%E4%BB%B6"><span class="nav-number">2.1.7.</span> <span class="nav-text">相关文件</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90"><span class="nav-number">2.2.</span> <span class="nav-text">文件权限</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AF%A6%E8%BF%B0"><span class="nav-number">2.2.1.</span> <span class="nav-text">详述</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#chmod"><span class="nav-number">2.2.2.</span> <span class="nav-text">chmod</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#chown"><span class="nav-number">2.2.3.</span> <span class="nav-text">chown</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%B6%E5%AE%83"><span class="nav-number">3.</span> <span class="nav-text">其它</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%86%B3%E5%AE%9A%E7%94%A8%E6%88%B7%E6%98%AF%E5%90%A6%E8%83%BDsudo"><span class="nav-number">3.1.</span> <span class="nav-text">决定用户是否能sudo</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%86%B3%E5%AE%9A%E7%94%A8%E6%88%B7%E6%98%AF%E5%90%A6%E8%83%BD%E8%BF%9C%E7%A8%8Bssh"><span class="nav-number">3.2.</span> <span class="nav-text">决定用户是否能远程ssh</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9D%83%E9%99%90%E6%8E%A7%E5%88%B6%E4%B8%8E%E8%BD%AF%E4%BB%B6%E5%AE%89%E8%A3%85"><span class="nav-number">4.</span> <span class="nav-text">权限控制与软件安装</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BD%AF%E4%BB%B6%E5%AE%89%E8%A3%85%E4%BD%8D%E7%BD%AE"><span class="nav-number">4.1.</span> <span class="nav-text">软件安装位置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%89%E8%A3%85%E4%BA%BA%E7%9A%84%E5%BD%B1%E5%93%8D"><span class="nav-number">4.2.</span> <span class="nav-text">安装人的影响</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%80%BB%E7%BB%93"><span class="nav-number">5.</span> <span class="nav-text">总结</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="果冻"
      src="https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83equib0YGKeGrRww67LyZ7hSONtAW59RHDTd2JuKmSfQLEs8zWIB14hUcHibNG41zNibv5mr5QhM5QDMQ/132">
  <p class="site-author-name" itemprop="name">果冻</p>
  <div class="site-description" itemprop="description">果冻的碎碎念</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">115</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">34</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">86</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://blog.csdn.net/zou8944" title="低质博客平台 → https:&#x2F;&#x2F;blog.csdn.net&#x2F;zou8944" rel="noopener" target="_blank"><i class="fa fa-th-large fa-fw"></i>低质博客平台</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://github.com/zou8944" title="同性交友网站 → https:&#x2F;&#x2F;github.com&#x2F;zou8944" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>同性交友网站</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        
  <div class="beian"><a href="https://beian.miit.gov.cn/" rel="noopener" target="_blank">粤ICP备2021024139号 </a>
  </div>

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">果冻</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>


    <script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>


        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>






<script>
  (function() {
    function leancloudSelector(url) {
      url = encodeURI(url);
      return document.getElementById(url).querySelector('.leancloud-visitors-count');
    }

    function addCount(Counter) {
      var visitors = document.querySelector('.leancloud_visitors');
      var url = decodeURI(visitors.id);
      var title = visitors.dataset.flagTitle;

      Counter('get', '/classes/Counter?where=' + encodeURIComponent(JSON.stringify({ url })))
        .then(response => response.json())
        .then(({ results }) => {
          if (results.length > 0) {
            var counter = results[0];
            leancloudSelector(url).innerText = counter.time + 1;
            Counter('put', '/classes/Counter/' + counter.objectId, { time: { '__op': 'Increment', 'amount': 1 } })
              .catch(error => {
                console.error('Failed to save visitor count', error);
              });
          } else {
              Counter('post', '/classes/Counter', { title, url, time: 1 })
                .then(response => response.json())
                .then(() => {
                  leancloudSelector(url).innerText = 1;
                })
                .catch(error => {
                  console.error('Failed to create', error);
                });
          }
        })
        .catch(error => {
          console.error('LeanCloud Counter Error', error);
        });
    }

    function showTime(Counter) {
      var visitors = document.querySelectorAll('.leancloud_visitors');
      var entries = [...visitors].map(element => {
        return decodeURI(element.id);
      });

      Counter('get', '/classes/Counter?where=' + encodeURIComponent(JSON.stringify({ url: { '$in': entries } })))
        .then(response => response.json())
        .then(({ results }) => {
          for (let url of entries) {
            let target = results.find(item => item.url === url);
            leancloudSelector(url).innerText = target ? target.time : 0;
          }
        })
        .catch(error => {
          console.error('LeanCloud Counter Error', error);
        });
    }

    let { app_id, app_key, server_url } = {"enable":true,"app_id":"ryE8EmVPz7F7UoBoHgb0sS3o-gzGzoHsz","app_key":"ts5Wga1uMoWcqyj4ABElP6uF","server_url":"https://www.zou8944.com","security":false};
    function fetchData(api_server) {
      var Counter = (method, url, data) => {
        return fetch(`${api_server}/1.1${url}`, {
          method,
          headers: {
            'X-LC-Id'     : app_id,
            'X-LC-Key'    : app_key,
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(data)
        });
      };
      if (CONFIG.page.isPost) {
        if (CONFIG.hostname !== location.hostname) return;
        addCount(Counter);
      } else if (document.querySelectorAll('.post-title-link').length >= 1) {
        showTime(Counter);
      }
    }

    let api_server = app_id.slice(-9) !== '-MdYXbMMI' ? server_url : `https://${app_id.slice(0, 8).toLowerCase()}.api.lncldglobal.com`;

    if (api_server) {
      fetchData(api_server);
    } else {
      fetch('https://app-router.leancloud.cn/2/route?appId=' + app_id)
        .then(response => response.json())
        .then(({ api_server }) => {
          fetchData('https://' + api_server);
        });
    }
  })();
</script>


      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

<script>
NexT.utils.loadComments(document.querySelector('#lv-container'), () => {
  window.livereOptions = {
    refer: location.pathname.replace(CONFIG.root, '').replace('index.html', '')
  };
  (function(d, s) {
    var j, e = d.getElementsByTagName(s)[0];
    if (typeof LivereTower === 'function') { return; }
    j = d.createElement(s);
    j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
    j.async = true;
    e.parentNode.insertBefore(j, e);
  })(document, 'script');
});
</script>

</body>
</html>
